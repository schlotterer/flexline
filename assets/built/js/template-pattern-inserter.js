/*! For license information please see template-pattern-inserter.js.LICENSE.txt */
!function(){function t(){var n,r,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function i(t,o,c,a){var i=o&&o.prototype instanceof l?o:l,s=Object.create(i.prototype);return e(s,"_invoke",function(t,e,o){var c,a,i,l=0,s=o||[],p=!1,f={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(t,e){return c=t,a=0,i=n,f.n=e,u}};function d(t,e){for(a=t,i=e,r=0;!p&&l&&!o&&r<s.length;r++){var o,c=s[r],d=f.p,v=c[2];t>3?(o=v===e)&&(i=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=n):c[0]<=d&&((o=t<2&&d<c[1])?(a=0,f.v=e,f.n=c[1]):d<v&&(o=t<3||c[0]>e||e>v)&&(c[4]=t,c[5]=e,f.n=v,a=0))}if(o||t>1)return u;throw p=!0,e}return function(o,s,v){if(l>1)throw TypeError("Generator is already running");for(p&&1===s&&d(s,v),a=s,i=v;(r=a<2?n:i)||!p;){c||(a?a<3?(a>1&&(f.n=-1),d(a,i)):f.n=i:f.v=i);try{if(l=2,c){if(a||(o="next"),r=c[o]){if(!(r=r.call(c,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,a<2&&(a=0)}else 1===a&&(r=c.return)&&r.call(c),a<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),a=1);c=n}else if((r=(p=f.n<0)?i:t.call(e,f))!==u)break}catch(t){c=n,a=1,i=t}finally{l=1}}return{value:r,done:p}}}(t,c,a),!0),s}var u={};function l(){}function s(){}function p(){}r=Object.getPrototypeOf;var f=[][c]?r(r([][c]())):(e(r={},c,function(){return this}),r),d=p.prototype=l.prototype=Object.create(f);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,e(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=p,e(d,"constructor",p),e(p,"constructor",s),s.displayName="GeneratorFunction",e(p,a,"GeneratorFunction"),e(d),e(d,a,"Generator"),e(d,c,function(){return this}),e(d,"toString",function(){return"[object Generator]"}),(t=function(){return{w:i,m:v}})()}function e(t,n,r,o){var c=Object.defineProperty;try{c({},"",{})}catch(t){c=0}e=function(t,n,r,o){function a(n,r){e(t,n,function(t){return this._invoke(n,r,t)})}n?c?c(t,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[n]=r:(a("next",0),a("throw",1),a("return",2))},e(t,n,r,o)}function n(t,e,n,r,o,c,a){try{var i=t[c](a),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,o)}function r(t){return function(){var e=this,r=arguments;return new Promise(function(o,c){var a=t.apply(e,r);function i(t){n(a,o,c,i,u,"next",t)}function u(t){n(a,o,c,i,u,"throw",t)}i(void 0)})}}!function(){console.log("[template-switcher] booting (with modal)…");var e=wp.data,n=e.select,o=e.resolveSelect,c=e.subscribe,a=e.dispatch,i=wp.blocks.parse,u=wp.element,l=u.createElement,s=u.createRoot,p=u.render,f=u.unmountComponentAtNode,d=wp.components,v=d.Modal,m=d.Button,h=d.Flex,y=function(){var t=n("core/edit-post");return!t||"function"!=typeof t.isEditorReady||t.isEditorReady()},b=function(){var t;return null===(t=n("core/editor").getPostEdits())||void 0===t?void 0:t.template},g=function(){return n("core/editor").getCurrentPostId()},w=function(){var e=r(t().m(function e(n){var r;return t().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,o("core").getEntityRecords("postType","wp_block",{per_page:-1,status:"publish",slug:n});case 1:return r=t.v,t.a(2,null==r?void 0:r[0])}},e)}));return function(t){return e.apply(this,arguments)}}(),k=function(t){var e;return!t||0===t.length||(!(1!==t.length||"core/paragraph"!==t[0].name||null!==(e=t[0].attributes)&&void 0!==e&&e.content&&""!==String(t[0].attributes.content).trim())||t.every(function(t){return"core/null"===t.name}))},_=function(t){return new Promise(function(e){var n=document.createElement("div");document.body.appendChild(n);var r=function(t){try{s&&n._root?n._root.unmount():null==f||f(n)}catch(t){}n.remove(),e(t)},o=function(){return l(v,{title:"Apply the starter content?",onRequestClose:function(){return r("cancel")}},[l("p",{style:{marginTop:0}},"Pattern - ".concat(t)),l(h,{gap:"8px",style:{marginTop:"12px"}},[l(m,{variant:"primary",onClick:function(){return r("replace")}},"Replace"),l(m,{variant:"primary",onClick:function(){return r("prepend")}},"Prepend"),l(m,{variant:"secondary",onClick:function(){return r("cancel")}},"Don't insert")])])};s?(n._root=s(n),n._root.render(l(o))):(p||wp.element.render)(l(o),n)})},P=null,j=!1,O=new Set;c(r(t().m(function e(){var r,o,c,u,l,s,p,f,d,v,m,h;return t().w(function(t){for(;;)switch(t.n){case 0:if(y()){t.n=1;break}return t.a(2);case 1:if((c=b())&&c!==P&&!j){t.n=2;break}return t.a(2);case 2:if(P=c,u=g(),l="".concat(u,":").concat(c),!O.has(l)){t.n=3;break}return t.a(2);case 3:return j=!0,s="".concat(c,"-starter"),console.log("[template-switcher] user changed template →",c,"| starter →",s),t.n=4,w(s);case 4:if(p=t.v){t.n=5;break}return console.info("[template-switcher] starter pattern missing; leaving blocks."),O.add(l),j=!1,t.a(2);case 5:if(f="string"==typeof p.content?p.content:(null===(r=p.content)||void 0===r?void 0:r.raw)||(null===(o=p.content)||void 0===o?void 0:o.rendered)||p.post_content||""){t.n=6;break}return console.warn("[template-switcher] starter has no markup; aborting."),O.add(l),j=!1,t.a(2);case 6:if(d=i(f),v=n("core/block-editor").getBlocks(),m="replace",k(v)){t.n=8;break}return t.n=7,_(s);case 7:m=t.v;case 8:if("cancel"!==m){t.n=9;break}return console.log("[template-switcher] user cancelled; no changes made."),j=!1,t.a(2);case 9:"replace"===m?((h=v.map(function(t){return t.clientId})).length&&a("core/block-editor").removeBlocks(h,!0),a("core/block-editor").insertBlocks(d,0)):"prepend"===m&&a("core/block-editor").insertBlocks(d,0),O.add(l),console.log("[template-switcher] starter injected via",m,"✓"),j=!1;case 10:return t.a(2)}},e)})))}()}();